# inorder

CPU симулятор In-Order-Execution'а.

## Язык

Симулятор работает только со специальным языком. Язык не совсем существует, поэтому внизу будут все доступные в нём команды. За основу был взят RISC-ассемблер MISC:


| Команда | Аргументы       | Что делает    |
|-------------|------------|-------------|
| lw          | `r1, X`          | `r1 = X`         |
| sw          | `r1, X`          | `X = r1`         |
| li          | `r1, #value`     | `li r1, #5` (r1 = 5) |
| add         | `r1, r2, r3`     | `r1 = r2 + r3`   |
| addi        | `r1, r2, #value` | `addi r0, r1, #5` (r0 = r1 + 5)   |
| sub         | `r1, r2, r3`     | `r1 = r2 - r3`   |
| subi        | `r1, r2, #value` | `subi r0, r1, #5` (r0 = r1 - 5)   |
| mul         | `r1, r2, r3`     | `r1 = r2 * r3`   |
| muli        | `r1, r2, #value` | `muli r0, r1, #5` (r0 = r1 * 5)   |
| div         | `r1, r2, r3`     | `r1 = r2 // r3`  |
| divi        | `r1, r2, #value` | `divi r0, r1, #5` (r0 = r1 // 5)   |

Обратитесь к [примерам](test/test_inorder.py) для подробного понимания и ознакомления.

## Симулятор

Симулятор принимает конфиг, задающий стоимость каждой операции, в каком блоке она выполняется и количество блоков.
Симулятор также полностью выполняет код, чтобы проверить его валидность.

Память симулятора состоит из двух python-dict'ов: `registers` и `memory`. По дефолту регистры в нашей системе это `r0, r1, r2, r3, r4` и так далее. Из них специальный -`r0` он указывает на подобие стека, которое для простоты мы называем *нестэк*.

Запуск: 
```
pytest -s


================================================================================
                        Результаты симуляции (Таймлайн)                         
================================================================================
Инструкция     | Start |   End | Таймлайн (Циклы 1..11)
---------------+---------+-------+------------
lw t1, 0(t0)   |     0 |     4 | #####······
add t2, t1, t1 |     5 |     5 | ·····#·····
sw t2, 4(t0)   |     6 |    10 | ······#####

ИТОГО ЦИКЛОВ: 11

================================================================================
                        Результаты симуляции (Таймлайн)                         
================================================================================
Инструкция     | Start |   End | Таймлайн (Циклы 1..26)
---------------+---------+-------+---------------------------
lw t1, 0(t0)   |     0 |     4 | #####·····················
lw t2, 4(t0)   |     5 |     9 | ·····#####················
add t3, t1, t2 |    10 |    10 | ··········#···············
lw t4, 8(t0)   |    10 |    14 | ··········#####···········
add t5, t1, t4 |    15 |    15 | ···············#··········
sw t5, 16(t0)  |    16 |    20 | ················#####·····
sw t3, 12(t0)  |    21 |    25 | ·····················#####

ИТОГО ЦИКЛОВ: 26
```

